PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE companies (
	id INTEGER NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	subscription_plan VARCHAR(50) NOT NULL, 
	active_projects_limit INTEGER NOT NULL, 
	price_per_project FLOAT NOT NULL, 
	billing_status VARCHAR(50) NOT NULL, 
	subscription_start_date DATETIME, 
	subscription_end_date DATETIME, 
	last_payment_date DATETIME, 
	next_billing_date DATETIME, 
	company_email VARCHAR(255), 
	company_phone VARCHAR(20), 
	company_address TEXT, 
	gstin VARCHAR(20), 
	is_active INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
);
INSERT INTO companies VALUES(1,'Test Construction Co.','trial',5,5000.0,'active',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,'2025-11-12 07:14:16.605612','2025-11-12 07:14:16.605617');
CREATE TABLE users (
	id INTEGER NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	phone VARCHAR(20) NOT NULL, 
	full_name VARCHAR(255) NOT NULL, 
	password_hash VARCHAR(255) NOT NULL, 
	company_id INTEGER, 
	is_support_admin INTEGER NOT NULL, 
	is_company_admin INTEGER NOT NULL, 
	is_system_admin INTEGER NOT NULL, 
	designation VARCHAR(100), 
	profile_photo VARCHAR(500), 
	is_active INTEGER NOT NULL, 
	is_email_verified INTEGER NOT NULL, 
	is_phone_verified INTEGER NOT NULL, 
	failed_login_attempts INTEGER NOT NULL, 
	account_locked_until DATETIME, 
	last_login DATETIME, 
	last_activity DATETIME, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	created_by INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id), 
	FOREIGN KEY(created_by) REFERENCES users (id)
);
INSERT INTO users VALUES(1,'test@example.com','+919876543210','Test User','scrypt:32768:8:1$McXlQgks3HIw1SWL$ef5f78f824f80d048a62587f7d883201232320c4c80959e8c87bbe4c378c6e5a4c4d8eec98471660de6a0d31c4f10b6068f5e947cfeb4de577e340e31f6ea422',1,0,0,0,NULL,NULL,1,0,0,0,NULL,'2025-11-12 07:24:26.703478',NULL,'2025-11-12 07:14:16.695804','2025-11-12 07:24:26.703963',NULL);
CREATE TABLE material_categories (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	category_name VARCHAR(100) NOT NULL, 
	category_code VARCHAR(20) NOT NULL, 
	description TEXT, 
	applicable_standards TEXT, 
	requires_testing INTEGER NOT NULL, 
	test_frequency VARCHAR(100), 
	is_active INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id)
);
CREATE TABLE projects (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	project_code VARCHAR(50), 
	description TEXT, 
	location VARCHAR(255), 
	client_name VARCHAR(255), 
	start_date DATETIME, 
	end_date DATETIME, 
	actual_end_date DATETIME, 
	status VARCHAR(50) NOT NULL, 
	is_active INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	created_by INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id), 
	UNIQUE (project_code), 
	FOREIGN KEY(created_by) REFERENCES users (id)
);
INSERT INTO projects VALUES(1,1,'Test Building Project','TBP-001','Test project for Material Vehicle Register','Mumbai, India','Test Client',NULL,NULL,NULL,'active',1,'2025-11-12 07:14:16.698704','2025-11-12 07:14:16.698707',NULL);
CREATE TABLE third_party_labs (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	lab_name VARCHAR(255) NOT NULL, 
	lab_code VARCHAR(50) NOT NULL, 
	contact_person_name VARCHAR(255) NOT NULL, 
	contact_phone VARCHAR(20) NOT NULL, 
	contact_email VARCHAR(255) NOT NULL, 
	address TEXT, 
	city VARCHAR(100), 
	state VARCHAR(100), 
	pincode VARCHAR(10), 
	nabl_accreditation_number VARCHAR(100), 
	nabl_accreditation_valid_till DATETIME, 
	scope_of_accreditation TEXT, 
	is_approved INTEGER NOT NULL, 
	approved_by INTEGER, 
	approved_at DATETIME, 
	is_active INTEGER NOT NULL, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id), 
	FOREIGN KEY(approved_by) REFERENCES users (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
CREATE TABLE approved_brands (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	category_id INTEGER NOT NULL, 
	brand_name VARCHAR(255) NOT NULL, 
	manufacturer_name VARCHAR(255) NOT NULL, 
	grade_specification VARCHAR(100), 
	compliance_standards TEXT, 
	approved_by INTEGER NOT NULL, 
	approved_at DATETIME NOT NULL, 
	approval_validity DATETIME, 
	type_test_certificate_name VARCHAR(255), 
	type_test_certificate_data BLOB, 
	type_test_certificate_mimetype VARCHAR(50), 
	is_active INTEGER NOT NULL, 
	remarks TEXT, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id), 
	FOREIGN KEY(category_id) REFERENCES material_categories (id), 
	FOREIGN KEY(approved_by) REFERENCES users (id)
);
CREATE TABLE project_memberships (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	role VARCHAR(64) NOT NULL, 
	can_create_batch INTEGER NOT NULL, 
	can_edit_batch INTEGER NOT NULL, 
	can_delete_batch INTEGER NOT NULL, 
	can_approve_batch INTEGER NOT NULL, 
	can_create_test INTEGER NOT NULL, 
	can_edit_test INTEGER NOT NULL, 
	can_delete_test INTEGER NOT NULL, 
	can_approve_test INTEGER NOT NULL, 
	can_manage_team INTEGER NOT NULL, 
	can_generate_reports INTEGER NOT NULL, 
	can_export_data INTEGER NOT NULL, 
	can_manage_settings INTEGER NOT NULL, 
	is_active INTEGER NOT NULL, 
	joined_at DATETIME NOT NULL, 
	added_by INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(user_id) REFERENCES users (id), 
	FOREIGN KEY(added_by) REFERENCES users (id)
);
INSERT INTO project_memberships VALUES(1,1,1,'QualityEngineer',1,1,0,0,1,1,0,0,0,1,0,0,1,'2025-11-12 07:14:16.700171',NULL);
CREATE TABLE rmc_vendors (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	project_id INTEGER, 
	vendor_name VARCHAR(255) NOT NULL, 
	contact_person_name VARCHAR(255) NOT NULL, 
	contact_phone VARCHAR(20) NOT NULL, 
	contact_email VARCHAR(255) NOT NULL, 
	address TEXT, 
	license_number VARCHAR(100), 
	gstin VARCHAR(20), 
	is_active INTEGER NOT NULL, 
	is_approved INTEGER NOT NULL, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	created_by INTEGER, 
	approved_at DATETIME, 
	approved_by INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES companies (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id), 
	FOREIGN KEY(created_by) REFERENCES users (id), 
	FOREIGN KEY(approved_by) REFERENCES users (id)
);
INSERT INTO rmc_vendors VALUES(1,1,1,'ABC Concrete Pvt Ltd','Auto-created','0000000000','autocreated@vendor.com',NULL,NULL,NULL,1,1,0,NULL,NULL,'2025-11-12 07:24:26.741413',NULL,NULL,NULL);
CREATE TABLE pour_activities (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	pour_id VARCHAR(100) NOT NULL, 
	pour_date DATETIME NOT NULL, 
	building_name VARCHAR(255), 
	floor_level VARCHAR(50), 
	zone VARCHAR(100), 
	grid_reference VARCHAR(100), 
	structural_element_type VARCHAR(50), 
	element_id VARCHAR(100), 
	location_description TEXT, 
	concrete_type VARCHAR(20) NOT NULL, 
	design_grade VARCHAR(50), 
	total_quantity_planned FLOAT NOT NULL, 
	total_quantity_received FLOAT, 
	status VARCHAR(20) NOT NULL, 
	started_at DATETIME, 
	completed_at DATETIME, 
	created_by INTEGER NOT NULL, 
	completed_by INTEGER, 
	remarks TEXT, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(created_by) REFERENCES users (id), 
	FOREIGN KEY(completed_by) REFERENCES users (id)
);
CREATE TABLE material_test_registers (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	category_id INTEGER NOT NULL, 
	brand_id INTEGER, 
	lab_id INTEGER NOT NULL, 
	material_description TEXT NOT NULL, 
	grade_specification VARCHAR(100) NOT NULL, 
	quantity FLOAT NOT NULL, 
	quantity_unit VARCHAR(20) NOT NULL, 
	supplier_name VARCHAR(255) NOT NULL, 
	manufacturer_name VARCHAR(255), 
	batch_lot_number VARCHAR(100) NOT NULL, 
	invoice_number VARCHAR(100) NOT NULL, 
	invoice_date DATETIME NOT NULL, 
	location_description TEXT NOT NULL, 
	lab_test_report_number VARCHAR(100) NOT NULL, 
	sample_collection_date DATETIME NOT NULL, 
	testing_date DATETIME NOT NULL, 
	test_parameters TEXT NOT NULL, 
	test_results TEXT NOT NULL, 
	pass_fail_status VARCHAR(20) NOT NULL, 
	certificate_photo_name VARCHAR(255) NOT NULL, 
	certificate_photo_data BLOB NOT NULL, 
	certificate_photo_mimetype VARCHAR(50) NOT NULL, 
	entered_by INTEGER NOT NULL, 
	verified_by INTEGER, 
	verified_at DATETIME, 
	verification_status VARCHAR(20) NOT NULL, 
	verification_remarks TEXT, 
	ncr_generated INTEGER NOT NULL, 
	ncr_number VARCHAR(100), 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(category_id) REFERENCES material_categories (id), 
	FOREIGN KEY(brand_id) REFERENCES approved_brands (id), 
	FOREIGN KEY(lab_id) REFERENCES third_party_labs (id), 
	FOREIGN KEY(entered_by) REFERENCES users (id), 
	FOREIGN KEY(verified_by) REFERENCES users (id), 
	UNIQUE (ncr_number), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
CREATE TABLE training_records (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	trainer_id INTEGER NOT NULL, 
	training_date DATETIME NOT NULL, 
	training_topic VARCHAR(255) NOT NULL, 
	trainee_names_json TEXT NOT NULL, 
	building VARCHAR(100) NOT NULL, 
	activity VARCHAR(100) NOT NULL, 
	duration_minutes INTEGER, 
	photo_filename VARCHAR(255) NOT NULL, 
	photo_data BLOB NOT NULL, 
	photo_mimetype VARCHAR(50) NOT NULL, 
	remarks TEXT, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(trainer_id) REFERENCES users (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
CREATE TABLE project_settings (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	enable_material_vehicle_addon INTEGER NOT NULL, 
	vehicle_allowed_time_hours FLOAT NOT NULL, 
	send_time_warnings INTEGER NOT NULL, 
	enable_test_reminders INTEGER NOT NULL, 
	reminder_time VARCHAR(10) NOT NULL, 
	notify_project_admins INTEGER NOT NULL, 
	notify_quality_engineers INTEGER NOT NULL, 
	enable_whatsapp_notifications INTEGER NOT NULL, 
	enable_email_notifications INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	updated_by INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (project_id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(updated_by) REFERENCES users (id)
);
CREATE TABLE mix_designs (
	id INTEGER NOT NULL, 
	project_id INTEGER, 
	rmc_vendor_id INTEGER, 
	project_name VARCHAR(255) NOT NULL, 
	mix_design_id VARCHAR(255) NOT NULL, 
	specified_strength_psi INTEGER NOT NULL, 
	concrete_grade VARCHAR(50), 
	is_self_compacting INTEGER NOT NULL, 
	is_free_flow INTEGER NOT NULL, 
	slump_inches FLOAT, 
	air_content_percent FLOAT, 
	batch_volume FLOAT, 
	volume_unit VARCHAR(32), 
	materials TEXT, 
	notes TEXT, 
	document_name VARCHAR(512), 
	ocr_text TEXT, 
	image_name VARCHAR(512), 
	image_data BLOB, 
	image_mimetype VARCHAR(100), 
	uploaded_by INTEGER, 
	is_approved INTEGER NOT NULL, 
	approved_by INTEGER, 
	approved_at DATETIME, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(rmc_vendor_id) REFERENCES rmc_vendors (id), 
	FOREIGN KEY(uploaded_by) REFERENCES users (id), 
	FOREIGN KEY(approved_by) REFERENCES users (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
INSERT INTO mix_designs VALUES(1,1,1,'Test Building Project','MD-M45FF-AUTO',6525,'M45FF',1,1,3.93700787401574814,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,1,1,'2025-11-12 07:24:26.742550',0,NULL,NULL,'2025-11-12 07:24:26.742845','2025-11-12 07:24:26.742848');
CREATE TABLE batch_registers (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	mix_design_id INTEGER NOT NULL, 
	rmc_vendor_id INTEGER NOT NULL, 
	pour_activity_id INTEGER, 
	batch_number VARCHAR(100) NOT NULL, 
	delivery_date DATETIME NOT NULL, 
	delivery_time VARCHAR(10), 
	quantity_ordered FLOAT NOT NULL, 
	quantity_received FLOAT, 
	batch_sheet_photo_name VARCHAR(512), 
	batch_sheet_photo_data BLOB, 
	batch_sheet_photo_mimetype VARCHAR(100), 
	vehicle_number VARCHAR(50), 
	driver_name VARCHAR(255), 
	temperature_celsius FLOAT, 
	slump_tested FLOAT, 
	building_name VARCHAR(255), 
	floor_level VARCHAR(50), 
	zone VARCHAR(100), 
	grid_reference VARCHAR(100), 
	structural_element_type VARCHAR(50), 
	element_id VARCHAR(100), 
	pour_location_description TEXT, 
	latitude FLOAT, 
	longitude FLOAT, 
	entered_by INTEGER NOT NULL, 
	verification_status VARCHAR(20) NOT NULL, 
	verified_by INTEGER, 
	verified_at DATETIME, 
	rejection_reason TEXT, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	remarks TEXT, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(mix_design_id) REFERENCES mix_designs (id), 
	FOREIGN KEY(rmc_vendor_id) REFERENCES rmc_vendors (id), 
	FOREIGN KEY(pour_activity_id) REFERENCES pour_activities (id), 
	FOREIGN KEY(entered_by) REFERENCES users (id), 
	FOREIGN KEY(verified_by) REFERENCES users (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
INSERT INTO batch_registers VALUES(1,1,1,1,NULL,'BATCH-2025-0001','2025-11-12 07:24:26.713390','07:24',1.0,1.0,NULL,NULL,NULL,'MH-01-1234','John Doe',32.0,100.0,'Building A','5th Floor Slab',NULL,NULL,'Slab',NULL,'Building A / 5th Floor Slab',NULL,NULL,1,'pending',NULL,NULL,NULL,0,NULL,NULL,NULL,'2025-11-12 07:24:26.743814','2025-11-12 07:24:26.743818');
CREATE TABLE cube_test_registers (
	id INTEGER NOT NULL, 
	batch_id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	set_number INTEGER NOT NULL, 
	test_age_days INTEGER NOT NULL, 
	cube_identifier VARCHAR(10), 
	pour_activity_id INTEGER, 
	third_party_lab_id INTEGER, 
	sent_to_lab_date DATETIME, 
	expected_result_date DATETIME, 
	casting_date DATETIME NOT NULL, 
	casting_time VARCHAR(10), 
	cast_by INTEGER NOT NULL, 
	structure_type VARCHAR(100), 
	structure_location TEXT, 
	concrete_grade VARCHAR(50), 
	concrete_type VARCHAR(20) NOT NULL, 
	concrete_source VARCHAR(20), 
	number_of_cubes INTEGER NOT NULL, 
	sample_identification VARCHAR(100), 
	curing_method VARCHAR(50), 
	curing_temperature FLOAT, 
	testing_date DATETIME, 
	tested_by INTEGER, 
	testing_machine_id VARCHAR(100), 
	machine_calibration_date DATETIME, 
	cube_1_weight_kg FLOAT, 
	cube_1_length_mm FLOAT, 
	cube_1_width_mm FLOAT, 
	cube_1_height_mm FLOAT, 
	cube_1_load_kn FLOAT, 
	cube_1_strength_mpa FLOAT, 
	cube_2_weight_kg FLOAT, 
	cube_2_length_mm FLOAT, 
	cube_2_width_mm FLOAT, 
	cube_2_height_mm FLOAT, 
	cube_2_load_kn FLOAT, 
	cube_2_strength_mpa FLOAT, 
	cube_3_weight_kg FLOAT, 
	cube_3_length_mm FLOAT, 
	cube_3_width_mm FLOAT, 
	cube_3_height_mm FLOAT, 
	cube_3_load_kn FLOAT, 
	cube_3_strength_mpa FLOAT, 
	average_strength_mpa FLOAT, 
	required_strength_mpa FLOAT, 
	strength_ratio_percent FLOAT, 
	pass_fail_status VARCHAR(20), 
	failure_mode_cube_1 VARCHAR(50), 
	failure_mode_cube_2 VARCHAR(50), 
	failure_mode_cube_3 VARCHAR(50), 
	verified_by INTEGER, 
	verified_at DATETIME, 
	ncr_generated INTEGER NOT NULL, 
	ncr_number VARCHAR(100), 
	notification_sent INTEGER NOT NULL, 
	tester_signature_data BLOB, 
	tester_signature_timestamp DATETIME, 
	verifier_signature_data BLOB, 
	verifier_signature_timestamp DATETIME, 
	remarks TEXT, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(batch_id) REFERENCES batch_registers (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(pour_activity_id) REFERENCES pour_activities (id), 
	FOREIGN KEY(third_party_lab_id) REFERENCES third_party_labs (id), 
	FOREIGN KEY(cast_by) REFERENCES users (id), 
	FOREIGN KEY(tested_by) REFERENCES users (id), 
	FOREIGN KEY(verified_by) REFERENCES users (id), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
CREATE TABLE third_party_cube_tests (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	batch_id INTEGER NOT NULL, 
	lab_id INTEGER NOT NULL, 
	lab_test_report_number VARCHAR(100) NOT NULL, 
	test_age_days INTEGER NOT NULL, 
	sample_collection_date DATETIME NOT NULL, 
	sample_received_at_lab_date DATETIME NOT NULL, 
	testing_date DATETIME NOT NULL, 
	number_of_cubes_tested INTEGER NOT NULL, 
	cube_1_strength_mpa FLOAT, 
	cube_2_strength_mpa FLOAT, 
	cube_3_strength_mpa FLOAT, 
	average_strength_mpa FLOAT NOT NULL, 
	required_strength_mpa FLOAT NOT NULL, 
	pass_fail_status VARCHAR(20) NOT NULL, 
	certificate_photo_name VARCHAR(255) NOT NULL, 
	certificate_photo_data BLOB NOT NULL, 
	certificate_photo_mimetype VARCHAR(50) NOT NULL, 
	verified_by INTEGER, 
	verified_at DATETIME, 
	verification_remarks TEXT, 
	ncr_generated INTEGER NOT NULL, 
	ncr_number VARCHAR(100), 
	notification_sent INTEGER NOT NULL, 
	is_deleted INTEGER NOT NULL, 
	deleted_at DATETIME, 
	deleted_by INTEGER, 
	remarks TEXT, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(batch_id) REFERENCES batch_registers (id), 
	FOREIGN KEY(lab_id) REFERENCES third_party_labs (id), 
	FOREIGN KEY(verified_by) REFERENCES users (id), 
	UNIQUE (ncr_number), 
	FOREIGN KEY(deleted_by) REFERENCES users (id)
);
CREATE TABLE material_vehicle_register (
	id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	vehicle_number VARCHAR(50) NOT NULL, 
	vehicle_type VARCHAR(100), 
	material_type VARCHAR(100) NOT NULL, 
	supplier_name VARCHAR(255), 
	challan_number VARCHAR(100), 
	driver_name VARCHAR(255), 
	driver_phone VARCHAR(20), 
	driver_license VARCHAR(50), 
	entry_time DATETIME NOT NULL, 
	exit_time DATETIME, 
	duration_hours FLOAT, 
	allowed_time_hours FLOAT, 
	exceeded_time_limit INTEGER NOT NULL, 
	time_warning_sent INTEGER NOT NULL, 
	time_warning_sent_at DATETIME, 
	photos TEXT, 
	status VARCHAR(50) NOT NULL, 
	purpose VARCHAR(255), 
	remarks TEXT, 
	linked_batch_id INTEGER, 
	is_linked_to_batch INTEGER NOT NULL, 
	created_by INTEGER NOT NULL, 
	updated_by INTEGER, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id), 
	FOREIGN KEY(linked_batch_id) REFERENCES batch_registers (id), 
	FOREIGN KEY(created_by) REFERENCES users (id), 
	FOREIGN KEY(updated_by) REFERENCES users (id)
);
INSERT INTO material_vehicle_register VALUES(1,1,'MH-01-1234','Concrete Mixer','Concrete','ABC Concrete Pvt Ltd','CH-2024-001','John Doe','+919876543210','MH-01-1234567','2025-11-12 07:24:26.713390',NULL,NULL,3.0,0,0,NULL,NULL,'on_site','Slab casting - Building A',NULL,1,1,1,1,'2025-11-12 07:24:26.713885','2025-11-12 07:24:26.744111');
INSERT INTO material_vehicle_register VALUES(2,1,'MH-02-5678','Truck','Steel','XYZ Steel Suppliers','ST-2024-001','Jane Smith','+919876543211',NULL,'2025-11-12 07:24:26.721234',NULL,NULL,3.0,0,0,NULL,NULL,'on_site','Steel delivery',NULL,NULL,0,1,NULL,'2025-11-12 07:24:26.721512','2025-11-12 07:24:26.721515');
CREATE TABLE test_reminders (
	id INTEGER NOT NULL, 
	cube_test_id INTEGER NOT NULL, 
	project_id INTEGER NOT NULL, 
	reminder_date DATETIME NOT NULL, 
	test_age_days INTEGER NOT NULL, 
	status VARCHAR(20) NOT NULL, 
	notification_sent_at DATETIME, 
	notified_user_ids TEXT, 
	test_completed INTEGER NOT NULL, 
	completed_at DATETIME, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(cube_test_id) REFERENCES cube_test_registers (id), 
	FOREIGN KEY(project_id) REFERENCES projects (id)
);
CREATE UNIQUE INDEX ix_users_email ON users (email);
CREATE INDEX ix_users_phone ON users (phone);
CREATE UNIQUE INDEX ix_material_categories_category_code ON material_categories (category_code);
CREATE UNIQUE INDEX ix_third_party_labs_lab_code ON third_party_labs (lab_code);
CREATE UNIQUE INDEX ix_pour_activities_pour_id ON pour_activities (pour_id);
CREATE INDEX ix_material_test_registers_lab_test_report_number ON material_test_registers (lab_test_report_number);
CREATE INDEX ix_training_records_building ON training_records (building);
CREATE INDEX ix_training_records_activity ON training_records (activity);
CREATE UNIQUE INDEX ix_batch_registers_batch_number ON batch_registers (batch_number);
CREATE UNIQUE INDEX ix_third_party_cube_tests_lab_test_report_number ON third_party_cube_tests (lab_test_report_number);
CREATE INDEX ix_test_reminders_reminder_date ON test_reminders (reminder_date);
COMMIT;
